# 功能規格：SaaS 登入頁面前端

**Feature Branch**: `001-saas-login-frontend`
**Created**: 2025-10-23
**Status**: Draft
**Input**: User description: "這是一個sass登入入口，底下有crm服務，共用會員的功能，該登入頁面會於使用者輸入後，與crm的api交握資料，確保使用者身分後才進入會員頁面，專案為前後端分離，先幫我完成登入頁面的前端規劃，前端專案放在frontend底下"

## 使用者場景與測試 *(必填)*

### 使用者故事 1 - 基本登入流程 (優先級: P1)

會員透過登入頁面輸入帳號密碼，系統驗證身份後導向會員專屬頁面。這是最核心的功能，讓已註冊的會員能夠存取受保護的資源。

**優先級理由**: 這是整個 SaaS 系統的入口閘道，沒有登入功能就無法存取任何會員功能。此為最小可行產品 (MVP) 的核心功能。

**獨立測試**: 可透過輸入有效的帳號密碼並成功導向會員頁面來完整測試，提供基本的身份驗證價值。

**驗收場景**:

1. **Given** 使用者尚未登入且位於登入頁面, **When** 使用者輸入有效的帳號和密碼並點擊登入按鈕, **Then** 系統應顯示載入狀態，呼叫 CRM API 驗證身份，驗證成功後導向至會員頁面
2. **Given** 使用者在登入頁面輸入帳號密碼, **When** 使用者輸入的帳號或密碼不正確, **Then** 系統應顯示友善的錯誤訊息（例如：「帳號或密碼錯誤，請重新輸入」），且不洩漏具體是帳號或密碼錯誤
3. **Given** 使用者已在登入頁面輸入資料, **When** 使用者點擊登入按鈕但網路連線失敗或 CRM API 無回應, **Then** 系統應顯示明確的錯誤訊息（例如：「連線失敗，請檢查網路狀態後重試」）並保留使用者輸入的帳號（密碼需清空）

---

### 使用者故事 2 - 登入狀態記憶 (優先級: P2)

會員成功登入後，在一定期間內關閉或重新開啟瀏覽器時，系統應保持登入狀態，無需重複輸入帳號密碼。

**優先級理由**: 提升使用者體驗，減少重複登入的摩擦，但不影響基本登入功能的運作。

**獨立測試**: 可透過成功登入後關閉瀏覽器，再次開啟時驗證是否仍保持登入狀態來測試，提供持續性登入體驗的價值。

**驗收場景**:

1. **Given** 使用者已成功登入並選擇「記住我」選項, **When** 使用者關閉瀏覽器後重新開啟並訪問登入頁面, **Then** 系統應自動檢查登入狀態，若 token 有效則直接導向會員頁面
2. **Given** 使用者已登入且 token 存在, **When** token 已過期或無效, **Then** 系統應清除本地儲存的 token 並要求使用者重新登入
3. **Given** 使用者成功登入但未選擇「記住我」選項, **When** 使用者關閉瀏覽器分頁, **Then** 系統應清除 session，下次訪問需重新登入

---

### 使用者故事 3 - 表單驗證與即時回饋 (優先級: P3)

使用者在填寫登入表單時，系統應提供即時的欄位驗證回饋，協助使用者正確填寫資料。

**優先級理由**: 提升使用體驗和減少無效的 API 呼叫，但不影響核心登入功能。

**獨立測試**: 可透過在表單欄位輸入無效資料（如空白、格式錯誤）並觀察即時驗證訊息來測試，提供更好的表單填寫體驗。

**驗收場景**:

1. **Given** 使用者位於登入頁面, **When** 使用者在帳號欄位輸入後離開焦點但該欄位為空白, **Then** 系統應顯示「此欄位為必填」的提示訊息
2. **Given** 使用者正在填寫登入表單, **When** 密碼長度不符合最小要求（例如少於 6 字元）, **Then** 系統應顯示「密碼長度至少需 6 個字元」的提示訊息
3. **Given** 使用者填寫表單時有驗證錯誤, **When** 使用者修正所有驗證錯誤, **Then** 錯誤訊息應即時消失，登入按鈕變為可點擊狀態

---

### 邊界案例

- 使用者在密碼欄位貼上包含特殊字元或空白的密碼時，系統應正確處理而不移除這些字元
- 使用者在多個裝置或瀏覽器同時登入時，系統應如何處理 session 管理（假設：允許多裝置同時登入，但每個裝置需各自驗證）
- 當 CRM API 回應時間過長（超過 10 秒）時，系統應顯示逾時訊息並允許使用者重試
- 使用者嘗試暴力破解（短時間內多次登入失敗）時，系統前端應配合後端的速率限制策略（假設：前端顯示後端回傳的錯誤訊息，如「嘗試次數過多，請稍後再試」）
- 使用者在登入過程中切換到其他分頁或應用程式，返回時系統應保持登入表單狀態

## 需求 *(必填)*

### 功能需求

- **FR-001**: 登入頁面必須提供帳號和密碼輸入欄位，兩者皆為必填
- **FR-002**: 登入頁面必須提供「記住我」選項，讓使用者選擇是否保持登入狀態
- **FR-003**: 使用者點擊登入按鈕時，系統必須顯示載入狀態（例如：按鈕 disabled 並顯示載入動畫）防止重複提交
- **FR-004**: 系統必須呼叫 CRM API 進行身份驗證，並處理驗證成功與失敗的情況
- **FR-005**: 驗證成功時，系統必須儲存驗證 token 並導向至會員頁面
- **FR-006**: 驗證失敗時，系統必須顯示友善且明確的錯誤訊息，且不洩漏敏感資訊（如具體是帳號或密碼錯誤）
- **FR-007**: 系統必須處理網路錯誤、API 逾時、API 回傳錯誤等異常狀況，並提供使用者可理解的錯誤訊息
- **FR-008**: 登入頁面必須在使用者輸入時提供即時欄位驗證（如必填欄位、格式驗證）
- **FR-009**: 系統必須在頁面載入時檢查是否已有有效的登入 token，若有則自動導向會員頁面
- **FR-010**: 密碼欄位必須以遮蔽方式顯示（type="password"），並提供「顯示/隱藏密碼」的切換功能
- **FR-011**: 登入頁面必須支援鍵盤操作（如按 Enter 鍵提交表單）
- **FR-012**: 所有錯誤訊息和使用者介面文字必須使用繁體中文
- **FR-013**: 登入頁面必須符合 WCAG 2.1 Level AA 無障礙標準（如適當的標籤、焦點管理、鍵盤導航）

### 關鍵實體 *(資料相關)*

- **登入表單資料**: 包含使用者輸入的帳號、密碼、是否記住登入狀態
- **驗證 Token**: CRM API 回傳的身份驗證憑證，用於後續 API 呼叫和維持登入狀態
- **使用者資訊**: 驗證成功後取得的基本使用者資料（如使用者 ID、名稱、權限等級），用於顯示和授權判斷
- **錯誤訊息**: 包含錯誤類型、使用者友善的訊息文字

## 成功標準 *(必填)*

### 可衡量成果

- **SC-001**: 使用者能在 5 秒內完成登入流程（從輸入資料到導向會員頁面）
- **SC-002**: 登入頁面在主流瀏覽器（Chrome、Firefox、Safari、Edge）上的首次內容繪製時間 (FCP) 應小於 1.5 秒
- **SC-003**: 90% 以上的使用者能在首次嘗試時成功登入（排除帳密錯誤的情況）
- **SC-004**: 表單驗證錯誤訊息必須在使用者操作後 100 毫秒內顯示
- **SC-005**: 所有互動元素（按鈕、輸入框、連結）必須在 100 毫秒內提供視覺回饋
- **SC-006**: 登入頁面必須通過所有 WCAG 2.1 Level AA 自動化檢測工具的檢查
- **SC-007**: 頁面在行動裝置（螢幕寬度 320px 至 428px）和桌面裝置（1024px 以上）上都能正常顯示和操作
- **SC-008**: CRM API 驗證請求的回應時間應在 2 秒內完成（99% 的情況下）

## 假設與依賴

### 假設

- CRM API 已存在且提供明確的身份驗證端點和回應格式
- CRM API 提供標準的 HTTP 狀態碼和錯誤訊息（如 401 表示驗證失敗、500 表示伺服器錯誤）
- 會員頁面的路徑已確定，登入成功後可直接導向
- 前端專案使用現代瀏覽器支援的標準技術（ES6+、Fetch API 或等效技術）
- Token 儲存方式遵循安全最佳實踐（假設使用 HttpOnly Cookie 或 localStorage 配合適當的安全措施）

### 依賴

- **CRM API**: 必須提供穩定可用的身份驗證服務
- **網路連線**: 使用者必須有可用的網路連線才能完成驗證
- **瀏覽器支援**: 使用者使用的瀏覽器必須支援現代網頁標準（假設支援 ES6+ 的常綠瀏覽器）

## 範圍界定

### 包含在此功能內

- 登入頁面的使用者介面設計與實作
- 表單驗證邏輯與使用者回饋
- 與 CRM API 的驗證整合
- Token 儲存與登入狀態管理
- 錯誤處理與使用者提示
- 無障礙功能與響應式設計

### 不包含在此功能內

- 註冊新帳號功能（未來功能）
- 忘記密碼與密碼重設功能（未來功能）
- 第三方登入整合（如 Google、Facebook SSO）（未來功能）
- 多因素驗證 (MFA)（未來功能）
- CRM API 的後端實作（已存在的服務）
- 會員頁面的實作（獨立功能）
- 帳號鎖定與解鎖機制（由 CRM API 後端處理）
